"0","all_vars_acs5 <- load_variables(year = 2019, "
"0","                                dataset = ""acs5"")"
"0",""
"0","# I want to see all of the possible variables to look at and so I grouped data by concept"
"0","all_vars_acs5$concept <- factor(all_vars_acs5$concept)"
"0",""
"0","#levels(all_vars_acs5$concept) # there are about 1134 possible variables to look at"
"0",""
"0","Arab_subset <- all_vars_acs5 %>% "
"0","  filter(str_detect(label, ""Arab"") | "
"0","           str_detect(label, ""ARAB"") |"
"0","           str_detect(concept, ""Arab"") |"
"0","           str_detect(concept, ""ARAB""))"
"0",""
"0","unique(Arab_subset$concept)"
"1","[1]"
"1"," PEOPLE REPORTING SINGLE ANCESTRY                                                       "
"1","
"
"1","[2]"
"1"," PEOPLE REPORTING MULTIPLE ANCESTRY                                                     "
"1","
"
"1","[3]"
"1"," PEOPLE REPORTING ANCESTRY                                                              "
"1","
"
"1","[4]"
"1"," PLACE OF BIRTH FOR THE FOREIGN-BORN POPULATION IN THE UNITED STATES                    "
"1","
"
"1","[5]"
"1"," LANGUAGE SPOKEN AT HOME BY ABILITY TO SPEAK ENGLISH FOR THE POPULATION 5 YEARS AND OVER"
"1","
"
"1","[6]"
"1"," LANGUAGE SPOKEN AT HOME FOR THE POPULATION 5 YEARS AND OVER                            "
"1","
"
"1","1134 "
"1",""
"1","Levels: "
"1",""
"1","AGE AND NATIVITY OF OWN CHILDREN UNDER 18 YEARS IN FAMILIES AND SUBFAMILIES BY NUMBER AND NATIVITY OF PARENTS ..."
"1",""
"1","
"
"0","# I did this to see what variables exist that I can use"
"0",""
"0","# I'm only interested in the variables related to total # of people"
"0","vars = Arab_subset$name[1:30]"
"0",""
"0","# Years I want to get data from"
"0","years <- 2014:2019"
"0",""
"0","# Subsetting data with above years"
"0","dfs_acs <- map(years, ~get_acs(geography = ""state"", variables = vars,"
"0","                               year = .x))"
"2","Getting data from the 2010-2014 5-year ACS
"
"2","Getting data from the 2011-2015 5-year ACS
"
"2","Getting data from the 2012-2016 5-year ACS
"
"2","Getting data from the 2013-2017 5-year ACS
"
"2","Getting data from the 2014-2018 5-year ACS
"
"2","Getting data from the 2015-2019 5-year ACS
"
"0","names(dfs_acs) <- paste0(""df_acs_"", years)"
"0",""
"0","list2env(dfs_acs, envir = .GlobalEnv)"
"1","<environment: R_GlobalEnv>
"
"0","# My data is stored in a list, and I want to combine it into a single data frame"
"0",""
"0","combined_df_all <- bind_cols(map(dfs_acs, ~select(.x, NAME, variable, estimate, moe)), .id = ""year"")"
"2","New names:"
"0","# combined_df_subset <- bind_cols(map(filtered_dfs, ~select(.x, NAME, variable, estimate, moe)), .id = ""year"")"
"0",""
"0","# Renaming data"
"0",""
"0","combined_df = combined_df_all %>% "
"0","  rename(""Variable"" = ""variable...2"","
"0","         ""State"" = ""NAME...1"","
"0","         ""2014_estimate"" = ""estimate...3"","
"0","         ""2014_moe"" = ""moe...4"","
"0","         ""2015_estimate"" = ""estimate...7"","
"0","         ""2015_moe"" = ""moe...8"","
"0","         ""2016_estimate"" = ""estimate...11"","
"0","         ""2016_moe"" = ""moe...12"","
"0","         ""2017_estimate"" = ""estimate...15"","
"0","         ""2017_moe"" = ""moe...16"","
"0","         ""2018_estimate"" = ""estimate...19"","
"0","         ""2018_moe"" = ""moe...20"","
"0","         ""2019_estimate"" = ""estimate...23"", "
"0","         ""2019_moe"" = ""moe...24"") %>% "
"0","  select(-starts_with(""variable..""), -starts_with(""NAME""))"
"0",""
"0",""
"0","# Keeping track of all these variable names is hard so I am just going to append the dataframe that contains the variable names and labels to the dataframe "
"0",""
"0","combined_df <- left_join(combined_df, Arab_subset, "
"0","                    by = c(""Variable"" = ""name""))"
"0",""
"0","# Define the recoding rules"
"0",""
"0","unique(combined_df$concept)"
"1","[1]"
"1"," PEOPLE REPORTING SINGLE ANCESTRY  "
"1","
"
"1","[2]"
"1"," PEOPLE REPORTING MULTIPLE ANCESTRY"
"1","
"
"1","[3]"
"1"," PEOPLE REPORTING ANCESTRY         "
"1","
"
"1","1134 "
"1",""
"1","Levels: "
"1",""
"1","AGE AND NATIVITY OF OWN CHILDREN UNDER 18 YEARS IN FAMILIES AND SUBFAMILIES BY NUMBER AND NATIVITY OF PARENTS ..."
"1",""
"1","
"
"0","recoding_rules <- c("
"0","  ""single_ancestry"" = ""PEOPLE REPORTING SINGLE ANCESTRY"","
"0","  ""multi_ancestry"" = ""PEOPLE REPORTING MULTIPLE ANCESTRY"","
"0","  ""ancestry"" = ""PEOPLE REPORTING ANCESTRY"")"
"0",""
"0",""
"0","combined_df=combined_df %>% "
"0","  mutate(concept=fct_recode(concept,!!!recoding_rules),"
"0","         label=str_remove(label, ""Estimate!!Total:!!""),"
"0","         label=str_remove(label, ""Arab:!!""),"
"0","         label=str_replace(label, ""Arab:"", ""Arab"")) %>% "
"0","  pivot_longer(cols = ends_with(""estimate"") | ends_with(""moe""),"
"0","               names_to = c("".value"", ""Type""),"
"0","               names_sep = ""_"") %>% "
"0","  pivot_longer(cols = starts_with(""201""),"
"0","    names_to = ""year"","
"0","    values_to = ""value"")"
"0",""
